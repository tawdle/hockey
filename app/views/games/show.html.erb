<%= javascript_tag do %>
  $(function() {
    App.game = new App.Game(<%= @game.to_json.html_safe %>);
    App.gameView = new App.GameView({ model: App.game });
  });
<% end %>

<h2 class="page-header"><%= @game.home_team.name %> <i>vs</i> <%= @game.visiting_team.name %> <br /> <small><%= @game.start_time.to_s(:long) %> at <%= @game.location.name %></small></h2>

<% if @game.scheduled? %>
  <p>This game is scheduled to start in <%= distance_of_time_in_words_to_now(@game.start_time) %>.</p>
<% elsif @game.active? || @game.paused? %>
  <p>This game is currently being played.
    <span id="game-clock" style="font-size:large; background-color: black; color: lightgreen; padding: 10px;">
      <%= @game.clock.elapsed_time_hms %>
    </span>
  </p>
  <%= render :partial => "score_board", :locals => {:game => @game } %>
<% elsif @game.finished? %>
  <p>This game ended.</p>
  <%= render :partial => "score_board", :locals => {:game => @game } %>
<% elsif @game.canceled? %>
  <p>This game was canceled.</p>
<% end %>

<div>
  <%= image_tag("sample_frame.png") %>
</div>

<% if can? :create, Goal.new(:game => @game) %>
  <div style="margin-top: 10px;">
    <%= link_to "Record Goal", new_game_goal_path(@game), :class => "btn" %>
    <%= link_to "See all Goals for this game", game_goals_path(@game), :class => "btn" %>
  </div>
<% end %>

<% if can?(:start, @game) %>
  <%= link_to "Start Game", start_game_path(@game, :format => :json), :method => :post, :remote => true, :id => "game-start", :class => "btn", :style => displayStyle(@game.can_start?) %>
<% end %>

<% if can? :stop, @game %>
  <%= link_to "Pause Game", stop_game_path(@game, :format => :json), :method => :post, :remote => true, :id => "game-pause", :class => "btn", :style => displayStyle(@game.can_pause?) %>
<% end %>

<%= render :partial => "activity_feed", :locals => { :new_activity_feed_item => ActivityFeedItem.new(:game => @game), :activity_feed_items => @game.activity_feed_items, :in_game_context => true } %>

<% content_for(:head) do %>
  <%= javascript_include_tag "http://localhost:8000/faye/client.js" %>
<% end %>


